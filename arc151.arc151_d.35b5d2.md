---
title: "ARC151_D_translation.md"
tags: []
author: ""
created: ""
---

## 题意 

已知一个长度为 $2^N$ 的序列 $A=(A_0,A_1,...,A_{2^N-1})$。

有 $Q$ 次操作，每次操作给出两个数 $X_i,Y_i$，进行以下操作：

> 对于所有 $0\le j < 2^N$，进行以下操作：
>
> 1. 首先令 $b_{N-1}b_{N-2}...b_0$ 是 $j$ 的二进制表示，也就是 $b_i\in \{ 0,1 \}$ 并且 $\sum_{i=0}^{N-1} b_i2^i=j $。然后把 $b_{X_i}$ 翻转（$0$ 变 $1$，$1$ 变 $0$），此时把 $b_{N-1}b_{N-2}...b_{0}$ 的十进制表示设为 $j'$。
> 2. 如果初始时 $b_{X_i}=Y_i$，那么令 $A_{j'}$ 加上 $A_j$。

按照输入的顺序进行每个操作，输出最后的序列 $A$，每个元素对 $998244353$ 取模。

## 数据范围

- $1\le N\le 18$
- $1\le Q\le 2\times 10^5$
- $0\le A_i < 998244353$
- $0\le X_i\le N-1$
- $Y_i\in \{ 0,1 \}$

## 输入格式

第一行两个数 $N,Q$。

第二行 $2^N$ 个数，表示序列 $A$。

接下来 $Q$ 行，每行两个数 $X_i,Y_i$ 表示一次操作。

## 输出格式

一行 $2^N$ 个数，表示操作结束后的 $A$ 序列。

## 样例

### 样例输入1

```
2 2
0 1 2 3
1 1
0 0
```

### 样例输出1

```
2 6 2 5
```

### 样例解释1

初始时，$A=(0,1,2,3)$。

第一次操作：

- 对于 $j=0$，$b_1b_0=00,j'=2$，因为 $b_1\ne 1$，所以跳过。
- 对于 $j=1$，$b_1b_0=01,j'=3$，因为 $b_1\ne 1$，所以跳过。
- 对于 $j=2$，$b_1b_0=10,j'=0$，因为 $b_1=1$，所以令 $A_0$ 去加上 $A_2$，得到 $A=(2,1,2,3)$。
- 对于 $j=3$，$b_1b_0=11,j'=1$，因为 $b_1=1$，所以令 $A_1$ 去加上 $A_3$，得到 $A=(2,4,2,3)$。

第二次操作：

- 对于 $j=0$，$b_1b_0=00,j'=1$，因为 $b_0=0$，所以令 $A_1$ 去加上 $A_0$，得到 $A=(2,6,2,3)$。
- 对于 $j=1$，$b_1b_0=01,j'=0$，因为 $b_0\ne 0$，所以跳过。
- 对于 $j=2$，$b_1b_0=10,j'=3$，因为 $b_0=0$，所以令 $A_3$ 去加上 $A_2$，得到 $A=(2,6,2,5)$。
- 对于 $j=3$，$b_1b_0=11,j'=2$，因为 $b_0=0$，所以跳过。

最后得到 $A=(2,6,2,5)$。

### 样例输入2

```
3 10
606248357 338306877 919152167 981537317 808873985 845549408 680941783 921035119
1 1
0 0
0 0
0 0
0 1
0 1
0 1
2 0
2 0
2 0
```

### 样例输出2

```
246895115 904824001 157201385 744260759 973709546 964549010 61683812 205420980
```

