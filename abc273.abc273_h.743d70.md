---
title: "ABC273_Ex_translation.md"
tags: []
author: ""
created: ""
---

### 题意 

有一个由整数数对组成的序列 $A$，初始时，$A=((0,1),(1,0))$。

可以对 $A$ 进行若干次以下操作：

- 选择相邻的两个数对 $(a,b),(c,d)$，在它们中间插入 $(a+c,b+d)$。

对于一个整数数对序列 $T$，定义 $f(T)$ 为：

- 令 $f(T)=$ 使得 $T$ 中所有的数对都在 $A$ 中出现所需要的最小操作次数。
- 如果无解，$f(T)=0$。

已知一个序列 $S=((a_1,b_1),(a_2,b_2),...,(a_N,b_N))$，它有 $\frac{N\times (N+1)}{2}$ 个子串 $S_{l,r}=((a_l,b_l),(a_{l+1},b_{l+1}),...,(a_r,b_r))$。

求 $\sum_{l=1}^N\sum_{r=l}^N f(S_{l,r})$，答案对 $998244353$ 取模。

### 数据范围

- $1\le N\le 10^5$
- $0\le a_i,b_i\le 10^9$。
- $(a_i,b_i)$ 互不相同。

---

### 输入格式

第一行一个数 $N$。

接下来 $N$ 行，每行两个数，表示 $a_i,b_i$。

### 输出格式

一行一个数，表示答案。

---

### 样例输入1

```
7
1 2
3 7
3 5
0 0
1000000000 1
0 1
6 3
```

### 样例输出1

```
3511324
```

### 样例解释1

- $f(S_{1,1})=2$
  - 操作为 $((0,1),(1,0))\to ((0,1),(1,1),(1,0))\to ((0,1),(1,2),(1,1),(1,0))$。
- $f(S_{1,2})=5$
- $f(S_{1,3})=7$
- $f(S_{2,2})=5$
- $f(S_{2,3})=7$
- $f(S_{3,3})=4$
- $f(S_{5,5})=10^9$
- $f(S_{5,6})=10^9$

- 其他情况 $f(S_{l,r})=0$
- 所以答案为 $2\times 10^9+30$，对 $998244353$ 取模后是 $3511324$。

