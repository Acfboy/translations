---
title: "ABC273_D_translation.md"
tags: []
author: ""
created: ""
---

## 题意

给出一个 $H \times M$ 的棋盘，左上角为 $(1,1)$。

有 $N$ 个位置 $(r_i,c_i)$ 有障碍物， Takahashi 最初在 $(r_s,c_s)$。

有 $Q$ 条指令，每条指令包含一个字符 $d_i$ 和一个正整数 $l_i$，其中 $d_i$ 为 `L` , `R` , `U` , `D` ，分别表示左、右、上、下。

对于第 $i$ 条指令， Takahashi 将作出 $l_i$ 次如下操作：

- 若与 $d_i$ 方向对应的相邻的那个点没有障碍物，则移动到那个点上，反之则什么都不做。

每次操作完后，输出 Takahashi 所在的点的坐标。

## 数据范围

- $2 \leq H,W \leq 10^9$

- $1 \leq r_s,r_i \leq H$

- $1 \leq c_s,c_i \leq W$

- $0 \leq N \leq 2 \times 10^5$

- $i \neq j \Rightarrow (r_i,c_i) \neq (r_j,c_j)$

- $\forall i \in {[1,N]},(r_s,c_s) \neq (r_i,c_i)$

- $1 \leq Q \leq 2 \times 10^5$

- $d_i$ 为 `L` , `R` , `U` , `D` 其一。

- $1 \leq l_i \leq 10^9$

- 除 $d_i$ 外所有输入均为整数。

## 输入格式

第一行输入四个整数 $H,W,r_s,c_s$。

第二行输入一个整数 $N$。

接下来 $N$ 行每行两个整数 $r_i,c_i$。

第 $N+3$ 行为一个整数 $Q$。

接下来 $Q$ 行每行一个字符 $d_i$ 及一个整数 $c_i$。

## 输出格式

输出共 $Q$ 行，第 $i$ 行为当前指令操作完后 Takahashi 所在的位置。

## 样例

### 样例输入1

```
5 5 4 4
3
5 3
2 2
1 4
4
L 2
U 3
L 2
R 4
```

### 样例输出1

```
4 2
3 2
3 1
3 5
```

### 样例解释1

初始棋盘如下（ `#` 为障碍物， `T` 为 Takahashi 所在的位置）：

```
...#.
.#...
.....
...T.
..#..
```

第 $1$ 条指令为向左走 $2$ 步， Takahashi 将在 $(4,2)$。

```
...#.
.#...
.....
.T...
..#..
```

第 $2$ 条指令为向上走 $3$ 步，但因为有障碍物，所以实际只走了 $1$ 步， Takahashi 将在 $(3,2)$。

```
...#.
.#...
.T...
.....
..#..
```

第 $3$ 条指令为向左走 $2$ 步，但因为无路可走，所以实际只走了 $1$ 步， Takahashi 将在 $(3,1)$。

```
...#.
.#...
T....
.....
..#..
```

第 $4$ 条指令为向右走 $4$ 步， Takahashi 将在 $(3,5)$。

```
...#.
.#...
....T
.....
..#..
```

### 样例输入2

```
6 6 6 3
7
3 1
4 3
2 6
3 4
5 5
1 1
3 2
10
D 3
U 3
L 2
D 2
U 3
D 3
U 3
R 3
L 3
D 1
```

### 样例输出2

```
6 3
5 3
5 1
6 1
4 1
6 1
4 1
4 2
4 1
5 1
```

